---
title: "testee"
author: "Fabien"
date: "2023-06-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Multiclass predomics

This document explains the method used to do multiclass classification with predomics.
To do the classification with the N-class instance dataset, I generated the N-binary classifier models using the one against all method and then merged them to form a single model at the output. For example, for a dataset of instances of classes 3 (A, B and C); I created three classifiers represented by the following equations:
classifier 1 = A + B - C - β > 0.
classifier 2 = A + C - B - β > 0.
classifier 3 = B + C - A - β > 0.

For the final multi-class classifier, I calculated the average of the metrics of all the N-binary classifiers.
final classifier = average(classifier 1, classifier 2, classifier 3).



```{r load the packages, message=FALSE, warning=FALSE}
library(mcpredomics)
library(predomics)
library(ggplot2)
library(gridExtra)
library(pROC)
library(reshape2)
```




```{r loading filtering the data, message=FALSE, warning=FALSE, paged.print=FALSE}
setwd("~/Documents/multiclasse_predomics/mcpredomics/data")
load(file = "mc.input.rda")
mcinput <- mc.input
str(mcinput, max.level = 1)
# Filter the non informative variables
X <- mcinput$X; y <- mcinput$y # set global variables
X <- X[rowSums(X)!=0,]; dim(X) # filter out variables with only zero values
X <- filterNoSignal(X = X, side = 1, threshold = "auto", verbose = FALSE); dim(X) 

```

```{r setting the classifier}
clf <- terga1_ovo(nCores = 1, 
              seed = 1, 
              plot = TRUE
)
printy(clf) # print the object for more information
isClf(clf)  # test whether the object is a classifier
class(clf)  # the class of the classifier object

```



```{r}
y <-  y[, 1]

y <- as.vector(y)
```

```{r}
 res_clf <- fit_OVO(X = X, y = y, clf = clf, cross.validate = TRUE, nfolds = 1); # class(res_clf
```


```{r}
res <- evaluateModel_ovo(mod = pop_last.mod[[1]],
                              X = X,
                              y = y,
                              clf = clf,
                              eval.all = eval.all,
                              force.re.evaluation = force.re.evaluation,
                              estim.feat.importance = estim.feat.importance,
                              mode = "train")
res
```







```{r}
Model_ovo <- evaluateModel_ovo(mod, X, y, clf, eval.all = FALSE, force.re.evaluation = FALSE, estim.feat.importance = FALSE, mode = 'train')
Model_ovo
```

```{r}
res_fit <- evaluateFit_ovo(mod = Model_ovo, X=X, y=y, clf=clf, force.re.evaluation = FALSE, mode = "train")
res_fit
```
```{r}
list <- list()
 for(i in 1:length(pop)){
   res <- cleanPopulation(pop = pop[[i]], clf = clf)
   list[[i]] <- res
 }
list
```

